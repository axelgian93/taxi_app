(()=>{var e={};e.id=691,e.ids=[691],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8582:(e,n,t)=>{"use strict";t.r(n),t.d(n,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d});var s=t(3191),a=t(8716),r=t(7922),l=t.n(r),i=t(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(n,o);let d=["",{children:["admin",{children:["ops",{children:["cities",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4939)),"/app/src/app/admin/ops/cities/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,2029)),"/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/app/src/app/admin/ops/cities/page.tsx"],u="/admin/ops/cities/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/ops/cities/page",pathname:"/admin/ops/cities",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9189:(e,n,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},4047:(e,n,t)=>{Promise.resolve().then(t.bind(t,933)),Promise.resolve().then(t.bind(t,6618)),Promise.resolve().then(t.bind(t,8482))},7175:(e,n,t)=>{Promise.resolve().then(t.bind(t,6444))},6444:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>i});var s=t(326),a=t(7577),r=t(6208),l=t(8145);function i(){let{show:e}=(0,l.p)(),[n,t]=(0,a.useState)([]),[i,o]=(0,a.useState)(!0),[d,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(null),[h,p]=(0,a.useState)({key:"",name:"",center:{lat:0,lng:0},zoom:12,bounds:void 0}),[g,b]=(0,a.useState)(null),[x,f]=(0,a.useState)(null);async function j(){o(!0),c(null);let e=(0,r.oC)();if(!e){location.href="/login";return}try{let n=await fetch("http://localhost:8081/admin/ops/cities",{headers:{Authorization:`Bearer ${e}`},cache:"no-store"});if(!n.ok)throw Error(`HTTP ${n.status}`);let s=await n.json();t(Array.isArray(s.items)?s.items:[])}catch(e){c(e?.message||"Error al cargar")}finally{o(!1)}}async function y(){if(c(null),m(null),!h.key.trim()||!h.name.trim()){c("Key y Nombre son obligatorios");return}if(h.center.lat<-90||h.center.lat>90||h.center.lng<-180||h.center.lng>180){c("Centro fuera de rango (-90..90, -180..180)");return}if((h.zoom??12)<1||(h.zoom??12)>20){c("Zoom fuera de rango (1..20)");return}let n=(0,r.oC)();if(!n){location.href="/login";return}try{let t={key:h.key.trim().toLowerCase(),name:h.name.trim(),center:{lat:Number(h.center.lat),lng:Number(h.center.lng)},zoom:Number(h.zoom||12)};if(h.bounds&&h.bounds.sw&&h.bounds.ne){let e=h.bounds;"number"==typeof e.sw.lat&&"number"==typeof e.sw.lng&&"number"==typeof e.ne.lat&&"number"==typeof e.ne.lng&&(t.bounds={sw:{lat:Number(e.sw.lat),lng:Number(e.sw.lng)},ne:{lat:Number(e.ne.lat),lng:Number(e.ne.lng)}})}let s=await fetch("http://localhost:8081/admin/ops/cities",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(t)});if(!s.ok)throw Error(`HTTP ${s.status}`);p({key:"",name:"",center:{lat:0,lng:0},zoom:12,bounds:void 0}),await j(),m("Ciudad creada"),e("Ciudad creada","success"),setTimeout(()=>m(null),2e3)}catch(e){c(e?.message||"Error al crear")}}async function v(n){if(!confirm("\xbfEliminar ciudad?"))return;let t=(0,r.oC)();if(!t){location.href="/login";return}try{let s=await fetch(`http://localhost:8081/admin/ops/cities/${encodeURIComponent(n)}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw Error(`HTTP ${s.status}`);await j(),m("Ciudad eliminada"),e("Ciudad eliminada","success"),setTimeout(()=>m(null),2e3)}catch(e){c(e?.message||"Error al eliminar")}}function w(){b(null),f(null)}async function N(){if(!g||!x)return;if(!x.name.trim()){c("Nombre es obligatorio");return}if(x.center.lat<-90||x.center.lat>90||x.center.lng<-180||x.center.lng>180){c("Centro fuera de rango (-90..90, -180..180)");return}if((x.zoom??12)<1||(x.zoom??12)>20){c("Zoom fuera de rango (1..20)");return}let n=(0,r.oC)();if(!n){location.href="/login";return}try{let t={};x.name&&(t.name=x.name),x.center&&"number"==typeof x.center.lat&&"number"==typeof x.center.lng&&(t.center={lat:Number(x.center.lat),lng:Number(x.center.lng)}),null!=x.zoom&&(t.zoom=Number(x.zoom));let s=await fetch(`http://localhost:8081/admin/ops/cities/${encodeURIComponent(g)}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(t)});if(!s.ok)throw Error(`HTTP ${s.status}`);b(null),f(null),await j(),m("Ciudad actualizada"),e("Ciudad actualizada","success"),setTimeout(()=>m(null),2e3)}catch(e){c(e?.message||"Error al actualizar")}}return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[s.jsx("h2",{children:"Ciudades"}),s.jsx("a",{className:"btn secondary",href:"/admin/ops",children:"Volver a Operaciones"})]}),s.jsx("div",{className:"card",style:{marginTop:10},children:(0,s.jsxs)("div",{className:"row",style:{gap:12,flexWrap:"wrap"},children:[(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"Key"}),s.jsx("input",{value:h.key,onChange:e=>p({...h,key:e.target.value}),placeholder:"guayaquil"})]}),(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"Nombre"}),s.jsx("input",{value:h.name,onChange:e=>p({...h,name:e.target.value}),placeholder:"Guayaquil"})]}),(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"Lat"}),s.jsx("input",{type:"number",step:"0.000001",value:h.center.lat,onChange:e=>p({...h,center:{...h.center,lat:Number(e.target.value)}})})]}),(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"Lng"}),s.jsx("input",{type:"number",step:"0.000001",value:h.center.lng,onChange:e=>p({...h,center:{...h.center,lng:Number(e.target.value)}})})]}),(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"Zoom"}),s.jsx("input",{type:"number",min:"1",max:"20",value:h.zoom||12,onChange:e=>p({...h,zoom:Number(e.target.value)})})]}),(0,s.jsxs)("div",{className:"row",style:{gap:8,flexWrap:"wrap",alignItems:"flex-end"},children:[s.jsx("div",{className:"muted",style:{width:"100%"},children:"Bounds (opcional)"}),(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"SW Lat"}),s.jsx("input",{type:"number",step:"0.000001",value:h.bounds?.sw?.lat??"",onChange:e=>p(n=>({...n,bounds:{...n.bounds||{sw:{lat:0,lng:0},ne:{lat:0,lng:0}},sw:{...n.bounds?.sw||{lat:0,lng:0},lat:Number(e.target.value||0)}}}))})]}),(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"SW Lng"}),s.jsx("input",{type:"number",step:"0.000001",value:h.bounds?.sw?.lng??"",onChange:e=>p(n=>({...n,bounds:{...n.bounds||{sw:{lat:0,lng:0},ne:{lat:0,lng:0}},sw:{...n.bounds?.sw||{lat:0,lng:0},lng:Number(e.target.value||0)}}}))})]}),(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"NE Lat"}),s.jsx("input",{type:"number",step:"0.000001",value:h.bounds?.ne?.lat??"",onChange:e=>p(n=>({...n,bounds:{...n.bounds||{sw:{lat:0,lng:0},ne:{lat:0,lng:0}},ne:{...n.bounds?.ne||{lat:0,lng:0},lat:Number(e.target.value||0)}}}))})]}),(0,s.jsxs)("label",{children:[s.jsx("div",{className:"muted",children:"NE Lng"}),s.jsx("input",{type:"number",step:"0.000001",value:h.bounds?.ne?.lng??"",onChange:e=>p(n=>({...n,bounds:{...n.bounds||{sw:{lat:0,lng:0},ne:{lat:0,lng:0}},ne:{...n.bounds?.ne||{lat:0,lng:0},lng:Number(e.target.value||0)}}}))})]})]}),s.jsx("button",{className:"btn",onClick:y,children:"Agregar"})]})}),d&&s.jsx("div",{style:{color:"var(--danger)",marginTop:10},children:d}),u&&s.jsx("div",{style:{color:"#22c55e",marginTop:10},children:u}),i?s.jsx("div",{children:"Cargando…"}):(0,s.jsxs)("table",{className:"table",style:{marginTop:12},children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"Key"}),s.jsx("th",{children:"Nombre"}),s.jsx("th",{children:"Centro"}),s.jsx("th",{children:"Zoom"}),s.jsx("th",{children:"Bounds"}),s.jsx("th",{})]})}),s.jsx("tbody",{children:n.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"muted",children:e.key}),g===e.key?(0,s.jsxs)(s.Fragment,{children:[s.jsx("td",{children:s.jsx("input",{value:x?.name||"",onChange:e=>f(n=>({...n,name:e.target.value}))})}),(0,s.jsxs)("td",{className:"row",style:{gap:6},children:[s.jsx("input",{type:"number",step:"0.000001",value:x?.center.lat??0,onChange:e=>f(n=>({...n,center:{...n.center,lat:Number(e.target.value)}}))}),s.jsx("input",{type:"number",step:"0.000001",value:x?.center.lng??0,onChange:e=>f(n=>({...n,center:{...n.center,lng:Number(e.target.value)}}))})]}),s.jsx("td",{children:s.jsx("input",{type:"number",min:1,max:20,value:x?.zoom??12,onChange:e=>f(n=>({...n,zoom:Number(e.target.value)}))})}),s.jsx("td",{children:(0,s.jsxs)("div",{className:"row",style:{gap:6,flexWrap:"wrap"},children:[s.jsx("input",{placeholder:"SW Lat",type:"number",step:"0.000001",value:x?.bounds?.sw?.lat??"",onChange:e=>f(n=>({...n,bounds:{...n.bounds||{sw:{lat:0,lng:0},ne:{lat:0,lng:0}},sw:{...n.bounds?.sw||{lat:0,lng:0},lat:Number(e.target.value||0)}}}))}),s.jsx("input",{placeholder:"SW Lng",type:"number",step:"0.000001",value:x?.bounds?.sw?.lng??"",onChange:e=>f(n=>({...n,bounds:{...n.bounds||{sw:{lat:0,lng:0},ne:{lat:0,lng:0}},sw:{...n.bounds?.sw||{lat:0,lng:0},lng:Number(e.target.value||0)}}}))}),s.jsx("input",{placeholder:"NE Lat",type:"number",step:"0.000001",value:x?.bounds?.ne?.lat??"",onChange:e=>f(n=>({...n,bounds:{...n.bounds||{sw:{lat:0,lng:0},ne:{lat:0,lng:0}},ne:{...n.bounds?.ne||{lat:0,lng:0},lat:Number(e.target.value||0)}}}))}),s.jsx("input",{placeholder:"NE Lng",type:"number",step:"0.000001",value:x?.bounds?.ne?.lng??"",onChange:e=>f(n=>({...n,bounds:{...n.bounds||{sw:{lat:0,lng:0},ne:{lat:0,lng:0}},ne:{...n.bounds?.ne||{lat:0,lng:0},lng:Number(e.target.value||0)}}}))}),s.jsx("button",{className:"btn secondary",onClick:()=>f(e=>e?{...e,bounds:null}:e),children:"Quitar bounds"})]})}),(0,s.jsxs)("td",{className:"row",style:{gap:6},children:[s.jsx("button",{className:"btn",onClick:N,children:"Guardar"}),s.jsx("button",{className:"btn secondary",onClick:w,children:"Cancelar"})]})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("td",{children:e.name}),(0,s.jsxs)("td",{className:"muted",children:[e.center.lat,", ",e.center.lng]}),s.jsx("td",{className:"muted",children:e.zoom??"-"}),s.jsx("td",{className:"muted",children:e.bounds?`${e.bounds.sw.lat},${e.bounds.sw.lng} — ${e.bounds.ne.lat},${e.bounds.ne.lng}`:"-"}),(0,s.jsxs)("td",{className:"row",style:{gap:6},children:[s.jsx("button",{className:"btn secondary",onClick:()=>(function(e){let n=new URLSearchParams;n.set("city",e.name),e.bounds?(n.set("swLat",String(e.bounds.sw.lat)),n.set("swLng",String(e.bounds.sw.lng)),n.set("neLat",String(e.bounds.ne.lat)),n.set("neLng",String(e.bounds.ne.lng))):(n.set("centerLat",String(e.center.lat)),n.set("centerLng",String(e.center.lng)),null!=e.zoom&&n.set("centerZoom",String(e.zoom))),location.href=`/admin/ops?${n.toString()}`})(e),children:"Usar en Operaciones"}),s.jsx("button",{className:"btn secondary",onClick:()=>{b(e.key),f({...e})},children:"Editar"}),s.jsx("button",{className:"btn secondary",onClick:()=>v(e.key),children:"Eliminar"})]})]})]},e.key))})]})]})}},8482:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>m});var s=t(326),a=t(7577),r=t.n(a),l=t(434),i=t(6208);let o="http://localhost:8081";function d(){let[e,n]=(0,a.useState)(()=>!1),[t,r]=(0,a.useState)(!1),[l,d]=(0,a.useState)(null);async function c(){r(!0),d(null);try{let e=(0,i.oC)();if(!e)throw Error("Inicia sesi\xf3n");let n=await fetch(`${o}/admin/demo/seed`,{method:"POST",headers:{Authorization:`Bearer ${e}`},cache:"no-store"});if(!n.ok)throw Error(`Seed HTTP ${n.status}`);d("Demo iniciada")}catch(e){d(e?.message||"Error en seed")}finally{r(!1)}}async function u(){r(!0),d(null);try{let e=(0,i.oC)();if(!e)throw Error("Inicia sesi\xf3n");let n=await fetch(`${o}/admin/demo/reset`,{method:"POST",headers:{Authorization:`Bearer ${e}`},cache:"no-store"});if(!n.ok)throw Error(`Reset HTTP ${n.status}`);d("Demo reseteada")}catch(e){d(e?.message||"Error en reset")}finally{r(!1)}}async function m(){let t=!e;n(t),t?await c():await u()}return(0,s.jsxs)("div",{style:{background:e?"#0b4":"#444",color:"white",padding:"6px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{className:"row",style:{gap:12,alignItems:"center"},children:[s.jsx("strong",{children:"Modo Demo"}),s.jsx("span",{className:"muted",children:e?"activo":"inactivo"}),l&&s.jsx("span",{style:{opacity:.8},children:l})]}),(0,s.jsxs)("div",{className:"row",style:{gap:8},children:[s.jsx("button",{className:"btn secondary",onClick:m,disabled:t,children:e?"Detener":"Iniciar"}),e&&s.jsx("button",{className:"btn secondary",onClick:u,disabled:t,children:"Reset ahora"})]})]})}function c(){let[e,n]=(0,a.useState)(""),[t,r]=(0,a.useState)("");if(!e)return null;let l=t?` ${t.toLowerCase()}`:"";return(0,s.jsxs)("span",{className:"muted",style:{marginLeft:12},children:["v",e,l?` (${l})`:""]})}var u=t(8145);function m({children:e}){return(0,s.jsxs)(s.Fragment,{children:[s.jsx(d,{}),(0,s.jsxs)("header",{className:"container",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)("div",{className:"row",children:[s.jsx("strong",{children:"Taxi App"}),(0,s.jsxs)("nav",{className:"row",style:{gap:16},children:[s.jsx(l.default,{href:"/",children:"Inicio"}),s.jsx(l.default,{href:"/admin/trips",children:"Trips"}),s.jsx(l.default,{href:"/admin/tariffs",children:"Tarifas"}),s.jsx(l.default,{href:"/admin/simulator",children:"Simulador"}),s.jsx(l.default,{href:"/admin/reports",children:"Reportes"}),s.jsx(l.default,{href:"/admin/ops",children:"Operaciones"})]})]}),s.jsx(h,{})]}),s.jsx(u.V,{children:s.jsx("main",{className:"container",children:e})}),(0,s.jsxs)("footer",{className:"container",style:{marginTop:24,paddingBottom:24,display:"flex",justifyContent:"flex-end",alignItems:"center"},children:[s.jsx(l.default,{href:"/admin/readme",children:"Gu\xeda de Demo"}),s.jsx(c,{})]})]})}function h(){let[e,n]=r().useState(()=>(0,i.PR)());return e?(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("span",{className:"muted",children:[e.email," (",e.role,")"]}),s.jsx("button",{className:"btn secondary",onClick:()=>{(0,i.DH)(),location.href="/login"},children:"Salir"})]}):s.jsx(l.default,{className:"btn secondary",href:"/login",children:"Ingresar"})}},8145:(e,n,t)=>{"use strict";t.d(n,{V:()=>i,p:()=>l});var s=t(326),a=t(7577);let r=(0,a.createContext)(null);function l(){let e=(0,a.useContext)(r);if(!e)throw Error("useToast must be used within ToastProvider");return e}function i({children:e}){let[n,t]=(0,a.useState)([]),l=(e,n="info",s=3200)=>{let a=Date.now()+Math.floor(1e3*Math.random()),r={id:a,kind:n,text:e,ttl:Date.now()+s};t(e=>[...e,r]),setTimeout(()=>t(e=>e.filter(e=>e.id!==a)),s)},i=(0,a.useMemo)(()=>({show:l}),[]);return(0,s.jsxs)(r.Provider,{value:i,children:[e,s.jsx("div",{style:{position:"fixed",top:12,right:12,display:"flex",flexDirection:"column",gap:8,zIndex:1e3},children:n.map(e=>(0,s.jsxs)("div",{className:"card",style:{padding:"10px 12px",minWidth:260,maxWidth:360,borderLeft:`4px solid ${"success"===e.kind?"#22c55e":"error"===e.kind?"#ef4444":"#3b82f6"}`},children:[s.jsx("div",{style:{fontWeight:600,marginBottom:2},children:"success"===e.kind?"\xc9xito":"error"===e.kind?"Error":"Info"}),s.jsx("div",{className:"muted",children:e.text})]},e.id))})]})}},6208:(e,n,t)=>{"use strict";function s(e,n){}function a(){return null}function r(){}function l(){return null}t.d(n,{DH:()=>r,J1:()=>s,PR:()=>a,oC:()=>l})},4939:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});let s=(0,t(8570).createProxy)(String.raw`/app/src/app/admin/ops/cities/page.tsx#default`)},2029:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>r});var s=t(9510);t(4315),t(1159);let a=(0,t(5782).default)(()=>t.e(298).then(t.bind(t,7298)),{loadableGenerated:{modules:["app/layout.tsx -> @/src/components/ClientShell"]},ssr:!1});function r({children:e}){return s.jsx("html",{lang:"es",children:s.jsx("body",{children:s.jsx(a,{children:e})})})}},4315:()=>{}};var n=require("../../../../webpack-runtime.js");n.C(e);var t=e=>n(n.s=e),s=n.X(0,[555],()=>t(8582));module.exports=s})();