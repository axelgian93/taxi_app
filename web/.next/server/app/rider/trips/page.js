(()=>{var e={};e.id=401,e.ids=[401],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7799:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>o});var r=s(3191),a=s(8716),i=s(7922),n=s.n(i),l=s(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(t,d);let o=["",{children:["rider",{children:["trips",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6211)),"/app/src/app/rider/trips/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/app/src/app/rider/trips/page.tsx"],u="/rider/trips/page",h={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/rider/trips/page",pathname:"/rider/trips",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9189:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},4047:(e,t,s)=>{Promise.resolve().then(s.bind(s,933)),Promise.resolve().then(s.bind(s,6618)),Promise.resolve().then(s.bind(s,8482))},4569:(e,t,s)=>{Promise.resolve().then(s.bind(s,6055))},6055:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(326),a=s(7577),i=s(6208),n=s(8069),l=s(434),d=s(2326);function o(){let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(null),[c,u]=(0,a.useState)(!1),[h,x]=(0,a.useState)(!0),[p,m]=(0,a.useState)(null),[j,f]=(0,a.useState)("ALL"),[g,v]=(0,a.useState)(""),[b,y]=(0,a.useState)(""),[C,E]=(0,a.useState)("");async function N(){let e=(0,i.oC)();if(e&&s){x(!0);try{let r=await (0,n.j)(`/rider/my-trips?limit=20&cursor=${encodeURIComponent(s)}`,{},e);t(e=>e.concat(r.items||[])),o(r.nextCursor||null),u(!!r.nextCursor)}catch(e){m(e?.message||"Error")}finally{x(!1)}}}if(h)return(0,r.jsxs)("div",{children:[r.jsx("h2",{children:"Mis viajes"}),r.jsx("div",{className:"card",style:{marginTop:10},children:r.jsx(d.ik,{lines:2})}),r.jsx("div",{className:"table-wrap",style:{marginTop:10},children:r.jsx(d.qM,{height:240})})]});if(p)return r.jsx("div",{style:{color:"var(--danger)"},children:p});let w=e.filter(e=>(function(e,t,s,r,a){if("ALL"===t)return!0;let i=!0;if(i="COMPLETED"===t?i&&"COMPLETED"===e.status:"CANCELED"===t?i&&"CANCELED"===e.status:i&&"COMPLETED"!==e.status&&"CANCELED"!==e.status,s&&!e.id.toLowerCase().includes(s.trim().toLowerCase())&&(i=!1),r){let t=Date.parse(e.requestedAt),s=Date.parse(r);isFinite(t)&&isFinite(s)&&t<s&&(i=!1)}if(a){let t=Date.parse(e.requestedAt),s=Date.parse(a+"T23:59:59");isFinite(t)&&isFinite(s)&&t>s&&(i=!1)}return i})(e,j,g,b,C)),P={total:w.length,completed:w.filter(e=>"COMPLETED"===e.status).length,canceled:w.filter(e=>"CANCELED"===e.status).length};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h2",{children:"Mis viajes"}),(0,r.jsxs)("div",{className:"row",style:{gap:8},children:[r.jsx("button",{className:"btn secondary",onClick:()=>(function(e){try{let t=["id","status","requestedAt","completedAt","costUsd","currency","preferredMethod"],s=e=>{if(null==e)return"";let t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?'"'+t.replace(/"/g,'""')+'"':t},r=[t.join(",")].concat(e.map(e=>t.map(t=>s(e[t])).join(","))),a=new Blob([r.join("\n")],{type:"text/csv;charset=utf-8"}),i=URL.createObjectURL(a),n=document.createElement("a");n.href=i,n.download=`mis_viajes_${new Date().toISOString().slice(0,19).replace(/[:T]/g,"-")}.csv`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}catch{}})(w),"aria-label":"Exportar viajes filtrados a CSV",children:"Export CSV"}),r.jsx(l.default,{className:"btn",href:"/rider/request","aria-label":"Solicitar nuevo viaje",children:"Solicitar viaje"})]})]}),r.jsx("div",{className:"card",style:{marginTop:8},children:(0,r.jsxs)("div",{className:"row",style:{gap:16,flexWrap:"wrap"},children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"muted",children:"Total"}),r.jsx("div",{style:{fontWeight:600},children:P.total})]}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"muted",children:"Completados"}),r.jsx("div",{style:{fontWeight:600},children:P.completed})]}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"muted",children:"Cancelados"}),r.jsx("div",{style:{fontWeight:600},children:P.canceled})]})]})}),r.jsx("div",{className:"row",style:{gap:8,margin:"8px 0"},children:["ALL","ACTIVE","COMPLETED","CANCELED"].map(e=>r.jsx("button",{className:`btn ${j===e?"":"secondary"}`,onClick:()=>f(e),"aria-pressed":j===e,"aria-label":`Filtrar ${e}`,children:"ALL"===e?"Todos":"ACTIVE"===e?"Activos":"COMPLETED"===e?"Completados":"Cancelados"},e))}),r.jsx("div",{className:"card",style:{margin:"8px 0"},children:(0,r.jsxs)("div",{className:"row",style:{gap:12,flexWrap:"wrap"},children:[(0,r.jsxs)("label",{children:[r.jsx("div",{className:"muted",children:"Buscar por ID"}),r.jsx("input",{"aria-label":"Buscar viaje por ID",placeholder:"trp_...",value:g,onChange:e=>v(e.target.value)})]}),(0,r.jsxs)("label",{children:[r.jsx("div",{className:"muted",children:"Desde"}),r.jsx("input",{type:"date","aria-label":"Fecha desde",value:b,onChange:e=>y(e.target.value)})]}),(0,r.jsxs)("label",{children:[r.jsx("div",{className:"muted",children:"Hasta"}),r.jsx("input",{type:"date","aria-label":"Fecha hasta",value:C,onChange:e=>E(e.target.value)})]})]})}),0===e.length?(0,r.jsxs)("div",{className:"muted",children:["A\xfan no tienes viajes. ",r.jsx(l.default,{href:"/rider/request",children:"Solicitar uno"})]}):(0,r.jsxs)("table",{className:"table","aria-label":"Lista de viajes",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Total"}),r.jsx("th",{children:"Pago"}),r.jsx("th",{})]})}),r.jsx("tbody",{children:w.map(e=>{var t;return(0,r.jsxs)("tr",{children:[r.jsx("td",{children:e.id}),r.jsx("td",{children:function(e){let t={REQUESTED:{text:"Solicitado",color:"#9aa4b2"},ASSIGNED:{text:"Asignado",color:"#06b6d4"},ACCEPTED:{text:"Aceptado",color:"#4f46e5"},ARRIVED:{text:"Lleg\xf3",color:"#22c55e"},STARTED:{text:"En curso",color:"#eab308"},COMPLETED:{text:"Completado",color:"#22c55e"},CANCELED:{text:"Cancelado",color:"#ef4444"}}[e]||{text:e,color:"#9aa4b2"};return r.jsx("span",{style:{padding:"2px 8px",borderRadius:999,background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.12)",color:t.color},children:t.text})}(e.status)}),r.jsx("td",{className:"muted",children:new Date(e.requestedAt).toLocaleString()}),r.jsx("td",{className:"muted",children:null!=e.costUsd?`$${Number(e.costUsd).toFixed(2)}`:"-"}),r.jsx("td",{children:(t=e.preferredMethod)?r.jsx("span",{style:{padding:"2px 8px",borderRadius:999,background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.12)",color:"CARD"===t?"#06b6d4":"#9aa4b2"},children:"CARD"===t?"Tarjeta":"Efectivo"}):r.jsx("span",{className:"muted",children:"-"})}),r.jsx("td",{children:r.jsx(l.default,{className:"btn secondary",href:`/rider/trip/${e.id}`,"aria-label":`Ver viaje ${e.id}`,children:"Ver"})})]},e.id)})})]}),c&&r.jsx("div",{style:{marginTop:8},children:r.jsx("button",{className:"btn",onClick:N,disabled:h,"aria-label":"Cargar m\xe1s viajes",children:h?"Cargandoâ€¦":"Cargar m\xe1s"})})]})}},8482:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(326),a=s(7577),i=s.n(a),n=s(434),l=s(6208);let d="http://localhost:8081";function o(){let[e,t]=(0,a.useState)(()=>!1),[s,i]=(0,a.useState)(!1),[n,o]=(0,a.useState)(null);async function c(){i(!0),o(null);try{let e=(0,l.oC)();if(!e)throw Error("Inicia sesi\xf3n");let t=await fetch(`${d}/admin/demo/seed`,{method:"POST",headers:{Authorization:`Bearer ${e}`},cache:"no-store"});if(!t.ok)throw Error(`Seed HTTP ${t.status}`);o("Demo iniciada")}catch(e){o(e?.message||"Error en seed")}finally{i(!1)}}async function u(){i(!0),o(null);try{let e=(0,l.oC)();if(!e)throw Error("Inicia sesi\xf3n");let t=await fetch(`${d}/admin/demo/reset`,{method:"POST",headers:{Authorization:`Bearer ${e}`},cache:"no-store"});if(!t.ok)throw Error(`Reset HTTP ${t.status}`);o("Demo reseteada")}catch(e){o(e?.message||"Error en reset")}finally{i(!1)}}async function h(){let s=!e;t(s),s?await c():await u()}return(0,r.jsxs)("div",{style:{background:e?"#0b4":"#444",color:"white",padding:"6px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)("div",{className:"row",style:{gap:12,alignItems:"center"},children:[r.jsx("strong",{children:"Modo Demo"}),r.jsx("span",{className:"muted",children:e?"activo":"inactivo"}),n&&r.jsx("span",{style:{opacity:.8},children:n})]}),(0,r.jsxs)("div",{className:"row",style:{gap:8},children:[r.jsx("button",{className:"btn secondary",onClick:h,disabled:s,children:e?"Detener":"Iniciar"}),e&&r.jsx("button",{className:"btn secondary",onClick:u,disabled:s,children:"Reset ahora"})]})]})}function c(){let[e,t]=(0,a.useState)(""),[s,i]=(0,a.useState)("");if(!e)return null;let n=s?` ${s.toLowerCase()}`:"";return(0,r.jsxs)("span",{className:"muted",style:{marginLeft:12},children:["v",e,n?` (${n})`:""]})}var u=s(8145);function h({children:e}){return(0,r.jsxs)(r.Fragment,{children:[r.jsx(o,{}),(0,r.jsxs)("header",{className:"container",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)("div",{className:"row",children:[r.jsx("strong",{children:"Taxi App"}),(0,r.jsxs)("nav",{className:"row",style:{gap:16},children:[r.jsx(n.default,{href:"/",children:"Inicio"}),r.jsx(n.default,{href:"/admin/trips",children:"Trips"}),r.jsx(n.default,{href:"/admin/tariffs",children:"Tarifas"}),r.jsx(n.default,{href:"/admin/simulator",children:"Simulador"}),r.jsx(n.default,{href:"/admin/reports",children:"Reportes"}),r.jsx(n.default,{href:"/admin/ops",children:"Operaciones"})]})]}),r.jsx(x,{})]}),r.jsx(u.V,{children:r.jsx("main",{className:"container",children:e})}),(0,r.jsxs)("footer",{className:"container",style:{marginTop:24,paddingBottom:24,display:"flex",justifyContent:"flex-end",alignItems:"center"},children:[r.jsx(n.default,{href:"/admin/readme",children:"Gu\xeda de Demo"}),r.jsx(c,{})]})]})}function x(){let[e,t]=i().useState(()=>(0,l.PR)());return e?(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("span",{className:"muted",children:[e.email," (",e.role,")"]}),r.jsx("button",{className:"btn secondary",onClick:()=>{(0,l.DH)(),location.href="/login"},children:"Salir"})]}):r.jsx(n.default,{className:"btn secondary",href:"/login",children:"Ingresar"})}},2326:(e,t,s)=>{"use strict";s.d(t,{ik:()=>i,qM:()=>a});var r=s(326);function a({height:e=16,width:t="100%",style:s,className:a}){return r.jsx("div",{className:a,style:{height:e,width:t,background:"linear-gradient(90deg, rgba(255,255,255,0.06) 25%, rgba(255,255,255,0.12) 37%, rgba(255,255,255,0.06) 63%)",backgroundSize:"400% 100%",animation:"skeleton 1.2s ease-in-out infinite",borderRadius:8,...s}})}function i({lines:e=3}){return r.jsx("div",{className:"row",style:{gap:8,flexDirection:"column"},children:Array.from({length:e}).map((e,t)=>r.jsx(a,{height:12,width:`${80-8*t}%`},t))})}s(7577)},8145:(e,t,s)=>{"use strict";s.d(t,{V:()=>l,p:()=>n});var r=s(326),a=s(7577);let i=(0,a.createContext)(null);function n(){let e=(0,a.useContext)(i);if(!e)throw Error("useToast must be used within ToastProvider");return e}function l({children:e}){let[t,s]=(0,a.useState)([]),n=(e,t="info",r=3200)=>{let a=Date.now()+Math.floor(1e3*Math.random()),i={id:a,kind:t,text:e,ttl:Date.now()+r};s(e=>[...e,i]),setTimeout(()=>s(e=>e.filter(e=>e.id!==a)),r)},l=(0,a.useMemo)(()=>({show:n}),[]);return(0,r.jsxs)(i.Provider,{value:l,children:[e,r.jsx("div",{style:{position:"fixed",top:12,right:12,display:"flex",flexDirection:"column",gap:8,zIndex:1e3},children:t.map(e=>(0,r.jsxs)("div",{className:"card",style:{padding:"10px 12px",minWidth:260,maxWidth:360,borderLeft:`4px solid ${"success"===e.kind?"#22c55e":"error"===e.kind?"#ef4444":"#3b82f6"}`},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:2},children:"success"===e.kind?"\xc9xito":"error"===e.kind?"Error":"Info"}),r.jsx("div",{className:"muted",children:e.text})]},e.id))})]})}},8069:(e,t,s)=>{"use strict";s.d(t,{S:()=>r,j:()=>a});let r="http://localhost:8081";async function a(e,t={},s){let a=new Headers(t.headers||{});a.set("Content-Type","application/json"),s&&a.set("Authorization",`Bearer ${s}`);let i=await fetch(`${r}${e}`,{...t,headers:a,cache:"no-store"});if(!i.ok){let e=await i.text().catch(()=>"");throw Error(`API ${i.status}: ${e||i.statusText}`)}return i.json()}},6208:(e,t,s)=>{"use strict";function r(e,t){}function a(){return null}function i(){}function n(){return null}s.d(t,{DH:()=>i,J1:()=>r,PR:()=>a,oC:()=>n})},2029:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(9510);s(4315),s(1159);let a=(0,s(5782).default)(()=>s.e(298).then(s.bind(s,7298)),{loadableGenerated:{modules:["app/layout.tsx -> @/src/components/ClientShell"]},ssr:!1});function i({children:e}){return r.jsx("html",{lang:"es",children:r.jsx("body",{children:r.jsx(a,{children:e})})})}},6211:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`/app/src/app/rider/trips/page.tsx#default`)},4315:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[555],()=>s(7799));module.exports=r})();