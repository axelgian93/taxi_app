(()=>{var e={};e.id=453,e.ids=[453],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7958:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=r(3191),n=r(8716),i=r(7922),a=r.n(i),l=r(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["driver",{children:["history",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5397)),"/app/src/app/driver/history/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,2029)),"/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/app/src/app/driver/history/page.tsx"],u="/driver/history/page",h={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/driver/history/page",pathname:"/driver/history",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9189:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},4047:(e,t,r)=>{Promise.resolve().then(r.bind(r,933)),Promise.resolve().then(r.bind(r,6618)),Promise.resolve().then(r.bind(r,8482))},5093:(e,t,r)=>{Promise.resolve().then(r.bind(r,5720))},5720:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(326),n=r(7577),i=r(434),a=r(8069),l=r(6208);function o(){let[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(null),[d,c]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),[m,x]=(0,n.useState)(null);async function p(e){h(!0),x(null);let r=(0,l.PR)();if(!r){location.replace("/login");return}if("DRIVER"!==r.role){x("Acceso solo para DRIVER"),h(!1);return}try{let r=(0,l.oC)();if(!r){location.replace("/login");return}let s=new URLSearchParams;e&&s.set("cursor",e);let n=await (0,a.j)(`/drivers/my-trips/history?${s.toString()}`,{},r);t(n.items||[]),c(n.nextCursor||null),o(e)}catch(e){x(e?.message||"Error")}finally{h(!1)}}return(0,s.jsxs)("div",{children:[s.jsx("h2",{children:"Historial de Viajes"}),m&&s.jsx("div",{style:{color:"var(--danger)"},children:m}),u?s.jsx("div",{className:"muted",children:"Cargandoâ€¦"}):0===e.length?s.jsx("div",{className:"muted",children:"Sin resultados"}):s.jsx("div",{className:"table-wrap",children:(0,s.jsxs)("table",{children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Estado"}),s.jsx("th",{children:"Solicitado"}),s.jsx("th",{children:"Completado"}),s.jsx("th",{children:"Monto"})]})}),s.jsx("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{children:e.id}),s.jsx("td",{children:e.status}),s.jsx("td",{children:new Date(e.requestedAt).toLocaleString()}),s.jsx("td",{children:e.completedAt?new Date(e.completedAt).toLocaleString():"-"}),s.jsx("td",{children:null!=e.costUsd?`$${Number(e.costUsd).toFixed(2)} ${e.currency||"USD"}`:"-"})]},e.id))})]})}),(0,s.jsxs)("div",{className:"row",style:{gap:8,marginTop:10},children:[s.jsx("button",{className:"btn secondary",onClick:()=>p(d),disabled:!d||u,children:"Siguiente"}),s.jsx("button",{className:"btn secondary",onClick:()=>p(null),disabled:u,children:"Volver al inicio"}),s.jsx(i.default,{className:"btn",href:"/driver",children:"Volver"})]})]})}},8482:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(326),n=r(7577),i=r.n(n),a=r(434),l=r(6208);let o="http://localhost:8081";function d(){let[e,t]=(0,n.useState)(()=>!1),[r,i]=(0,n.useState)(!1),[a,d]=(0,n.useState)(null);async function c(){i(!0),d(null);try{let e=(0,l.oC)();if(!e)throw Error("Inicia sesi\xf3n");let t=await fetch(`${o}/admin/demo/seed`,{method:"POST",headers:{Authorization:`Bearer ${e}`},cache:"no-store"});if(!t.ok)throw Error(`Seed HTTP ${t.status}`);d("Demo iniciada")}catch(e){d(e?.message||"Error en seed")}finally{i(!1)}}async function u(){i(!0),d(null);try{let e=(0,l.oC)();if(!e)throw Error("Inicia sesi\xf3n");let t=await fetch(`${o}/admin/demo/reset`,{method:"POST",headers:{Authorization:`Bearer ${e}`},cache:"no-store"});if(!t.ok)throw Error(`Reset HTTP ${t.status}`);d("Demo reseteada")}catch(e){d(e?.message||"Error en reset")}finally{i(!1)}}async function h(){let r=!e;t(r),r?await c():await u()}return(0,s.jsxs)("div",{style:{background:e?"#0b4":"#444",color:"white",padding:"6px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{className:"row",style:{gap:12,alignItems:"center"},children:[s.jsx("strong",{children:"Modo Demo"}),s.jsx("span",{className:"muted",children:e?"activo":"inactivo"}),a&&s.jsx("span",{style:{opacity:.8},children:a})]}),(0,s.jsxs)("div",{className:"row",style:{gap:8},children:[s.jsx("button",{className:"btn secondary",onClick:h,disabled:r,children:e?"Detener":"Iniciar"}),e&&s.jsx("button",{className:"btn secondary",onClick:u,disabled:r,children:"Reset ahora"})]})]})}function c(){let[e,t]=(0,n.useState)(""),[r,i]=(0,n.useState)("");if(!e)return null;let a=r?` ${r.toLowerCase()}`:"";return(0,s.jsxs)("span",{className:"muted",style:{marginLeft:12},children:["v",e,a?` (${a})`:""]})}var u=r(8145);function h({children:e}){return(0,s.jsxs)(s.Fragment,{children:[s.jsx(d,{}),(0,s.jsxs)("header",{className:"container",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)("div",{className:"row",children:[s.jsx("strong",{children:"Taxi App"}),(0,s.jsxs)("nav",{className:"row",style:{gap:16},children:[s.jsx(a.default,{href:"/",children:"Inicio"}),s.jsx(a.default,{href:"/admin/trips",children:"Trips"}),s.jsx(a.default,{href:"/admin/tariffs",children:"Tarifas"}),s.jsx(a.default,{href:"/admin/simulator",children:"Simulador"}),s.jsx(a.default,{href:"/admin/reports",children:"Reportes"}),s.jsx(a.default,{href:"/admin/ops",children:"Operaciones"})]})]}),s.jsx(m,{})]}),s.jsx(u.V,{children:s.jsx("main",{className:"container",children:e})}),(0,s.jsxs)("footer",{className:"container",style:{marginTop:24,paddingBottom:24,display:"flex",justifyContent:"flex-end",alignItems:"center"},children:[s.jsx(a.default,{href:"/admin/readme",children:"Gu\xeda de Demo"}),s.jsx(c,{})]})]})}function m(){let[e,t]=i().useState(()=>(0,l.PR)());return e?(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("span",{className:"muted",children:[e.email," (",e.role,")"]}),s.jsx("button",{className:"btn secondary",onClick:()=>{(0,l.DH)(),location.href="/login"},children:"Salir"})]}):s.jsx(a.default,{className:"btn secondary",href:"/login",children:"Ingresar"})}},8145:(e,t,r)=>{"use strict";r.d(t,{V:()=>l,p:()=>a});var s=r(326),n=r(7577);let i=(0,n.createContext)(null);function a(){let e=(0,n.useContext)(i);if(!e)throw Error("useToast must be used within ToastProvider");return e}function l({children:e}){let[t,r]=(0,n.useState)([]),a=(e,t="info",s=3200)=>{let n=Date.now()+Math.floor(1e3*Math.random()),i={id:n,kind:t,text:e,ttl:Date.now()+s};r(e=>[...e,i]),setTimeout(()=>r(e=>e.filter(e=>e.id!==n)),s)},l=(0,n.useMemo)(()=>({show:a}),[]);return(0,s.jsxs)(i.Provider,{value:l,children:[e,s.jsx("div",{style:{position:"fixed",top:12,right:12,display:"flex",flexDirection:"column",gap:8,zIndex:1e3},children:t.map(e=>(0,s.jsxs)("div",{className:"card",style:{padding:"10px 12px",minWidth:260,maxWidth:360,borderLeft:`4px solid ${"success"===e.kind?"#22c55e":"error"===e.kind?"#ef4444":"#3b82f6"}`},children:[s.jsx("div",{style:{fontWeight:600,marginBottom:2},children:"success"===e.kind?"\xc9xito":"error"===e.kind?"Error":"Info"}),s.jsx("div",{className:"muted",children:e.text})]},e.id))})]})}},8069:(e,t,r)=>{"use strict";r.d(t,{S:()=>s,j:()=>n});let s="http://localhost:8081";async function n(e,t={},r){let n=new Headers(t.headers||{});n.set("Content-Type","application/json"),r&&n.set("Authorization",`Bearer ${r}`);let i=await fetch(`${s}${e}`,{...t,headers:n,cache:"no-store"});if(!i.ok){let e=await i.text().catch(()=>"");throw Error(`API ${i.status}: ${e||i.statusText}`)}return i.json()}},6208:(e,t,r)=>{"use strict";function s(e,t){}function n(){return null}function i(){}function a(){return null}r.d(t,{DH:()=>i,J1:()=>s,PR:()=>n,oC:()=>a})},5397:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/app/src/app/driver/history/page.tsx#default`)},2029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(9510);r(4315),r(1159);let n=(0,r(5782).default)(()=>r.e(298).then(r.bind(r,7298)),{loadableGenerated:{modules:["app/layout.tsx -> @/src/components/ClientShell"]},ssr:!1});function i({children:e}){return s.jsx("html",{lang:"es",children:s.jsx("body",{children:s.jsx(n,{children:e})})})}},4315:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[555],()=>r(7958));module.exports=s})();