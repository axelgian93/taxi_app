(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[453],{9284:function(t,e,n){Promise.resolve().then(n.bind(n,9836))},9836:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return i}});var r=n(7437),l=n(2265),c=n(7138),o=n(2800),a=n(4282);function i(){let[t,e]=(0,l.useState)([]),[n,i]=(0,l.useState)(null),[s,u]=(0,l.useState)(null),[d,h]=(0,l.useState)(!0),[f,x]=(0,l.useState)(null);async function g(t){h(!0),x(null);let n=(0,a.PR)();if(!n){location.replace("/login");return}if("DRIVER"!==n.role){x("Acceso solo para DRIVER"),h(!1);return}try{let n=(0,a.oC)();if(!n){location.replace("/login");return}let r=new URLSearchParams;t&&r.set("cursor",t);let l=await (0,o.j)("/drivers/my-trips/history?".concat(r.toString()),{},n);e(l.items||[]),u(l.nextCursor||null),i(t)}catch(t){x((null==t?void 0:t.message)||"Error")}finally{h(!1)}}return(0,l.useEffect)(()=>{g(null)},[]),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Historial de Viajes"}),f&&(0,r.jsx)("div",{style:{color:"var(--danger)"},children:f}),d?(0,r.jsx)("div",{className:"muted",children:"Cargandoâ€¦"}):0===t.length?(0,r.jsx)("div",{className:"muted",children:"Sin resultados"}):(0,r.jsx)("div",{className:"table-wrap",children:(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Estado"}),(0,r.jsx)("th",{children:"Solicitado"}),(0,r.jsx)("th",{children:"Completado"}),(0,r.jsx)("th",{children:"Monto"})]})}),(0,r.jsx)("tbody",{children:t.map(t=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:t.id}),(0,r.jsx)("td",{children:t.status}),(0,r.jsx)("td",{children:new Date(t.requestedAt).toLocaleString()}),(0,r.jsx)("td",{children:t.completedAt?new Date(t.completedAt).toLocaleString():"-"}),(0,r.jsx)("td",{children:null!=t.costUsd?"$".concat(Number(t.costUsd).toFixed(2)," ").concat(t.currency||"USD"):"-"})]},t.id))})]})}),(0,r.jsxs)("div",{className:"row",style:{gap:8,marginTop:10},children:[(0,r.jsx)("button",{className:"btn secondary",onClick:()=>g(s),disabled:!s||d,children:"Siguiente"}),(0,r.jsx)("button",{className:"btn secondary",onClick:()=>g(null),disabled:d,children:"Volver al inicio"}),(0,r.jsx)(c.default,{className:"btn",href:"/driver",children:"Volver"})]})]})}},2800:function(t,e,n){"use strict";n.d(e,{S:function(){return r},j:function(){return l}});let r="http://localhost:8081";async function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,l=new Headers(e.headers||{});l.set("Content-Type","application/json"),n&&l.set("Authorization","Bearer ".concat(n));let c=await fetch("".concat(r).concat(t),{...e,headers:l,cache:"no-store"});if(!c.ok){let t=await c.text().catch(()=>"");throw Error("API ".concat(c.status,": ").concat(t||c.statusText))}return c.json()}},4282:function(t,e,n){"use strict";n.d(e,{DH:function(){return i},J1:function(){return o},PR:function(){return a},oC:function(){return s}});var r=n(6300).Buffer;let l="taxi_token",c="taxi_user";function o(t,e){localStorage.setItem(l,t),localStorage.setItem(c,JSON.stringify(e))}function a(){let t=localStorage.getItem(c);if(!t)return null;try{return JSON.parse(t)}catch(t){return null}}function i(){localStorage.removeItem(l),localStorage.removeItem(c)}function s(){let t=localStorage.getItem(l);return t?!function(t){let e=function(t){let e=t.split(".");if(3!==e.length)return null;try{let t=function(t){try{let e=t.length%4==2?"==":t.length%4==3?"=":t.length%4==1?"===":"",n=t.replace(/-/g,"+").replace(/_/g,"/")+e;if("function"==typeof atob)return atob(n);return r.from(n,"base64").toString("binary")}catch(t){return""}}(e[1]);return JSON.parse(t)}catch(t){return null}}(t);return null!=e&&!!e.exp&&Math.floor(Date.now()/1e3)>=e.exp}(t)?t:(i(),null):null}}},function(t){t.O(0,[300,138,971,23,744],function(){return t(t.s=9284)}),_N_E=t.O()}]);