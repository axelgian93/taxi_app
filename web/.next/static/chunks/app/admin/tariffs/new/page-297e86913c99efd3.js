(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[963],{5380:function(e,t,n){Promise.resolve().then(n.bind(n,28))},28:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(7437),a=n(2265),l=n(7138),i=n(2800),c=n(4282);function u(){let[e,t]=(0,a.useState)({city:"",active:!0,baseFareUsd:1.5,perKmUsd:.5,perMinUsd:.15,minFareUsd:2,nightMultiplier:1,weekendMultiplier:1,surgeMultiplier:1,nightStartHour:"",nightEndHour:"",cancellationGraceSec:120,cancellationFeeAcceptedUsd:1,cancellationFeeArrivedUsd:2,notes:"",deactivateOld:!0}),[n,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)(null);async function p(t){t.preventDefault(),h(null);let n=(0,c.PR)();if(!n||"ADMIN"!==n.role){location.href="/login";return}let r=(0,c.oC)();if(!r){location.href="/login";return}u(!0);try{var a;let t={city:e.city.trim(),active:!!e.active,baseFareUsd:Number(e.baseFareUsd),perKmUsd:Number(e.perKmUsd),perMinUsd:Number(e.perMinUsd),minFareUsd:Number(e.minFareUsd||0),nightMultiplier:Number(e.nightMultiplier||1),weekendMultiplier:Number(e.weekendMultiplier||1),surgeMultiplier:Number(e.surgeMultiplier||1),nightStartHour:""===e.nightStartHour?null:Number(e.nightStartHour),nightEndHour:""===e.nightEndHour?null:Number(e.nightEndHour),cancellationGraceSec:""===e.cancellationGraceSec?null:Number(e.cancellationGraceSec),cancellationFeeAcceptedUsd:""===e.cancellationFeeAcceptedUsd?null:Number(e.cancellationFeeAcceptedUsd),cancellationFeeArrivedUsd:""===e.cancellationFeeArrivedUsd?null:Number(e.cancellationFeeArrivedUsd),notes:(null===(a=e.notes)||void 0===a?void 0:a.trim())||null,deactivateOld:!!e.deactivateOld};await (0,i.j)("/admin/tariffs",{method:"POST",body:JSON.stringify(t)},r),location.href="/admin/tariffs"}catch(e){h((null==e?void 0:e.message)||"Error al crear")}finally{u(!1)}}return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("h2",{children:"Nueva Tarifa"}),(0,r.jsx)(l.default,{className:"btn secondary",href:"/admin/tariffs",children:"Volver"})]}),(0,r.jsxs)("form",{onSubmit:p,className:"card",style:{display:"grid",gap:12,maxWidth:820},children:[(0,r.jsxs)(s,{children:[(0,r.jsx)(o,{label:"Ciudad",children:(0,r.jsx)("input",{value:e.city,onChange:n=>t({...e,city:n.target.value}),required:!0})}),(0,r.jsx)(o,{label:"Activa",children:(0,r.jsx)("input",{type:"checkbox",checked:e.active,onChange:n=>t({...e,active:n.target.checked})})})]}),(0,r.jsxs)(s,{children:[(0,r.jsx)(o,{label:"Base $",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.baseFareUsd,onChange:n=>t({...e,baseFareUsd:n.target.value}),required:!0})}),(0,r.jsx)(o,{label:"$ por km",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.perKmUsd,onChange:n=>t({...e,perKmUsd:n.target.value}),required:!0})}),(0,r.jsx)(o,{label:"$ por min",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.perMinUsd,onChange:n=>t({...e,perMinUsd:n.target.value}),required:!0})}),(0,r.jsx)(o,{label:"M\xednimo $",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.minFareUsd,onChange:n=>t({...e,minFareUsd:n.target.value})})})]}),(0,r.jsxs)(s,{children:[(0,r.jsx)(o,{label:"Mult. noche",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.nightMultiplier,onChange:n=>t({...e,nightMultiplier:n.target.value})})}),(0,r.jsx)(o,{label:"Mult. fin de semana",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.weekendMultiplier,onChange:n=>t({...e,weekendMultiplier:n.target.value})})}),(0,r.jsx)(o,{label:"Surge",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.surgeMultiplier,onChange:n=>t({...e,surgeMultiplier:n.target.value})})})]}),(0,r.jsxs)(s,{children:[(0,r.jsx)(o,{label:"Hora inicio noche",children:(0,r.jsx)("input",{type:"number",min:"0",max:"23",value:e.nightStartHour,onChange:n=>t({...e,nightStartHour:n.target.value})})}),(0,r.jsx)(o,{label:"Hora fin noche",children:(0,r.jsx)("input",{type:"number",min:"0",max:"23",value:e.nightEndHour,onChange:n=>t({...e,nightEndHour:n.target.value})})}),(0,r.jsx)(o,{label:"Gracia cancelaci\xf3n (s)",children:(0,r.jsx)("input",{type:"number",min:"0",value:e.cancellationGraceSec,onChange:n=>t({...e,cancellationGraceSec:n.target.value})})})]}),(0,r.jsxs)(s,{children:[(0,r.jsx)(o,{label:"Fee cancelaci\xf3n ACCEPTED $",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.cancellationFeeAcceptedUsd,onChange:n=>t({...e,cancellationFeeAcceptedUsd:n.target.value})})}),(0,r.jsx)(o,{label:"Fee cancelaci\xf3n ARRIVED $",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:e.cancellationFeeArrivedUsd,onChange:n=>t({...e,cancellationFeeArrivedUsd:n.target.value})})}),(0,r.jsx)(o,{label:"Desactivar previas",children:(0,r.jsx)("input",{type:"checkbox",checked:e.deactivateOld,onChange:n=>t({...e,deactivateOld:n.target.checked})})})]}),(0,r.jsx)(o,{label:"Notas",children:(0,r.jsx)("input",{value:e.notes,onChange:n=>t({...e,notes:n.target.value})})}),d&&(0,r.jsx)("div",{style:{color:"var(--danger)"},children:d}),(0,r.jsx)("div",{className:"row",style:{justifyContent:"flex-end"},children:(0,r.jsx)("button",{className:"btn",disabled:n,children:n?"Guardandoâ€¦":"Crear"})})]})]})}function s(e){let{children:t}=e;return(0,r.jsx)("div",{className:"row",style:{gap:16,flexWrap:"wrap"},children:t})}function o(e){let{label:t,children:n}=e;return(0,r.jsxs)("label",{style:{display:"grid"},children:[(0,r.jsx)("div",{className:"muted",children:t}),n]})}},2800:function(e,t,n){"use strict";n.d(t,{S:function(){return r},j:function(){return a}});let r="http://localhost:8081";async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=new Headers(t.headers||{});a.set("Content-Type","application/json"),n&&a.set("Authorization","Bearer ".concat(n));let l=await fetch("".concat(r).concat(e),{...t,headers:a,cache:"no-store"});if(!l.ok){let e=await l.text().catch(()=>"");throw Error("API ".concat(l.status,": ").concat(e||l.statusText))}return l.json()}},4282:function(e,t,n){"use strict";n.d(t,{DH:function(){return u},J1:function(){return i},PR:function(){return c},oC:function(){return s}});var r=n(6300).Buffer;let a="taxi_token",l="taxi_user";function i(e,t){localStorage.setItem(a,e),localStorage.setItem(l,JSON.stringify(t))}function c(){let e=localStorage.getItem(l);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function u(){localStorage.removeItem(a),localStorage.removeItem(l)}function s(){let e=localStorage.getItem(a);return e?!function(e){let t=function(e){let t=e.split(".");if(3!==t.length)return null;try{let e=function(e){try{let t=e.length%4==2?"==":e.length%4==3?"=":e.length%4==1?"===":"",n=e.replace(/-/g,"+").replace(/_/g,"/")+t;if("function"==typeof atob)return atob(n);return r.from(n,"base64").toString("binary")}catch(e){return""}}(t[1]);return JSON.parse(e)}catch(e){return null}}(e);return null!=t&&!!t.exp&&Math.floor(Date.now()/1e3)>=t.exp}(e)?e:(u(),null):null}}},function(e){e.O(0,[300,138,971,23,744],function(){return e(e.s=5380)}),_N_E=e.O()}]);