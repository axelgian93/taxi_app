(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[870],{4104:function(e,n,t){Promise.resolve().then(t.bind(t,7378))},7378:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return u}});var r=t(7437),l=t(2265),a=t(7138),i=t(2800),c=t(4282),s=t(21);function u(e){var n,t,u,h,g,p,m,f,v,x;let{params:b}=e,j=b.id,[y,N]=(0,l.useState)(null),[C,S]=(0,l.useState)(!0),[k,U]=(0,l.useState)(!1),[M,w]=(0,l.useState)(null);async function A(e){e.preventDefault(),w(null);let n=(0,c.oC)();if(!n){location.href="/login";return}U(!0);try{var t;let e={city:y.city,active:!!y.active,baseFareUsd:Number(y.baseFareUsd),perKmUsd:Number(y.perKmUsd),perMinUsd:Number(y.perMinUsd),minFareUsd:Number(y.minFareUsd||0),nightMultiplier:Number(y.nightMultiplier||1),weekendMultiplier:Number(y.weekendMultiplier||1),surgeMultiplier:Number(y.surgeMultiplier||1),nightStartHour:""===y.nightStartHour?null:Number(y.nightStartHour),nightEndHour:""===y.nightEndHour?null:Number(y.nightEndHour),cancellationGraceSec:""===y.cancellationGraceSec?null:Number(y.cancellationGraceSec),cancellationFeeAcceptedUsd:""===y.cancellationFeeAcceptedUsd?null:Number(y.cancellationFeeAcceptedUsd),cancellationFeeArrivedUsd:""===y.cancellationFeeArrivedUsd?null:Number(y.cancellationFeeArrivedUsd),notes:(null===(t=y.notes)||void 0===t?void 0:t.trim())||null};await (0,i.j)("/admin/tariffs/".concat(encodeURIComponent(j)),{method:"PATCH",body:JSON.stringify(e)},n),location.href="/admin/tariffs"}catch(e){w((null==e?void 0:e.message)||"Error al guardar")}finally{U(!1)}}return((0,l.useEffect)(()=>{let e=(0,c.PR)();if(!e){location.replace("/login");return}if("ADMIN"!==e.role){w("Acceso solo para ADMIN"),S(!1);return}let n=(0,c.oC)();if(!n){location.replace("/login");return}S(!0),(0,i.j)("/admin/tariffs",{},n).then(e=>{let n=(e.items||[]).find(e=>e.id===j);if(!n)throw Error("No encontrada");N({...n})}).catch(e=>w((null==e?void 0:e.message)||"Error al cargar")).finally(()=>S(!1))},[j]),C)?(0,r.jsxs)("div",{className:"card",style:{padding:12},children:[(0,r.jsxs)("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)(s.qM,{height:24,width:200}),(0,r.jsx)(s.qM,{height:32,width:120})]}),(0,r.jsx)("div",{style:{marginTop:10},children:(0,r.jsx)(s.ik,{lines:3})})]}):M?(0,r.jsx)("div",{style:{color:"var(--danger)"},children:M}):y?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("h2",{children:"Editar Tarifa"}),(0,r.jsx)(a.default,{className:"btn secondary",href:"/admin/tariffs",children:"Volver"})]}),(0,r.jsxs)("form",{onSubmit:A,className:"card",style:{display:"grid",gap:12,maxWidth:820},children:[(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{label:"Ciudad",children:(0,r.jsx)("input",{value:y.city,onChange:e=>N({...y,city:e.target.value}),required:!0})}),(0,r.jsx)(d,{label:"Activa",children:(0,r.jsx)("input",{type:"checkbox",checked:y.active,onChange:e=>N({...y,active:e.target.checked})})})]}),(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{label:"Base $",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:y.baseFareUsd,onChange:e=>N({...y,baseFareUsd:e.target.value}),required:!0})}),(0,r.jsx)(d,{label:"$ por km",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:y.perKmUsd,onChange:e=>N({...y,perKmUsd:e.target.value}),required:!0})}),(0,r.jsx)(d,{label:"$ por min",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:y.perMinUsd,onChange:e=>N({...y,perMinUsd:e.target.value}),required:!0})}),(0,r.jsx)(d,{label:"M\xednimo $",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:null!==(n=y.minFareUsd)&&void 0!==n?n:"",onChange:e=>N({...y,minFareUsd:e.target.value})})})]}),(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{label:"Mult. noche",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:null!==(t=y.nightMultiplier)&&void 0!==t?t:"",onChange:e=>N({...y,nightMultiplier:e.target.value})})}),(0,r.jsx)(d,{label:"Mult. fin de semana",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:null!==(u=y.weekendMultiplier)&&void 0!==u?u:"",onChange:e=>N({...y,weekendMultiplier:e.target.value})})}),(0,r.jsx)(d,{label:"Surge",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:null!==(h=y.surgeMultiplier)&&void 0!==h?h:"",onChange:e=>N({...y,surgeMultiplier:e.target.value})})})]}),(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{label:"Hora inicio noche",children:(0,r.jsx)("input",{type:"number",min:"0",max:"23",value:null!==(g=y.nightStartHour)&&void 0!==g?g:"",onChange:e=>N({...y,nightStartHour:e.target.value})})}),(0,r.jsx)(d,{label:"Hora fin noche",children:(0,r.jsx)("input",{type:"number",min:"0",max:"23",value:null!==(p=y.nightEndHour)&&void 0!==p?p:"",onChange:e=>N({...y,nightEndHour:e.target.value})})}),(0,r.jsx)(d,{label:"Gracia cancelaci\xf3n (s)",children:(0,r.jsx)("input",{type:"number",min:"0",value:null!==(m=y.cancellationGraceSec)&&void 0!==m?m:"",onChange:e=>N({...y,cancellationGraceSec:e.target.value})})})]}),(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{label:"Fee cancelaci\xf3n ACCEPTED $",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:null!==(f=y.cancellationFeeAcceptedUsd)&&void 0!==f?f:"",onChange:e=>N({...y,cancellationFeeAcceptedUsd:e.target.value})})}),(0,r.jsx)(d,{label:"Fee cancelaci\xf3n ARRIVED $",children:(0,r.jsx)("input",{type:"number",step:"0.01",value:null!==(v=y.cancellationFeeArrivedUsd)&&void 0!==v?v:"",onChange:e=>N({...y,cancellationFeeArrivedUsd:e.target.value})})})]}),(0,r.jsx)(d,{label:"Notas",children:(0,r.jsx)("input",{value:null!==(x=y.notes)&&void 0!==x?x:"",onChange:e=>N({...y,notes:e.target.value})})}),M&&(0,r.jsx)("div",{style:{color:"var(--danger)"},children:M}),(0,r.jsx)("div",{className:"row",style:{justifyContent:"flex-end"},children:(0,r.jsx)("button",{className:"btn",disabled:k,children:k?"Guardandoâ€¦":"Guardar"})})]})]}):(0,r.jsx)("div",{children:"No encontrada"})}function o(e){let{children:n}=e;return(0,r.jsx)("div",{className:"row",style:{gap:16,flexWrap:"wrap"},children:n})}function d(e){let{label:n,children:t}=e;return(0,r.jsxs)("label",{style:{display:"grid"},children:[(0,r.jsx)("div",{className:"muted",children:n}),t]})}},21:function(e,n,t){"use strict";t.d(n,{ik:function(){return a},qM:function(){return l}});var r=t(7437);function l(e){let{height:n=16,width:t="100%",style:l,className:a}=e;return(0,r.jsx)("div",{className:a,style:{height:n,width:t,background:"linear-gradient(90deg, rgba(255,255,255,0.06) 25%, rgba(255,255,255,0.12) 37%, rgba(255,255,255,0.06) 63%)",backgroundSize:"400% 100%",animation:"skeleton 1.2s ease-in-out infinite",borderRadius:8,...l}})}function a(e){let{lines:n=3}=e;return(0,r.jsx)("div",{className:"row",style:{gap:8,flexDirection:"column"},children:Array.from({length:n}).map((e,n)=>(0,r.jsx)(l,{height:12,width:"".concat(80-8*n,"%")},n))})}if(t(2265),!document.getElementById("sk-keyframes")){let e=document.createElement("style");e.id="sk-keyframes",e.innerHTML="@keyframes skeleton { 0%{background-position:100% 50%} 100%{background-position:0 50%} }",document.head.appendChild(e)}},2800:function(e,n,t){"use strict";t.d(n,{S:function(){return r},j:function(){return l}});let r="http://localhost:8081";async function l(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0,l=new Headers(n.headers||{});l.set("Content-Type","application/json"),t&&l.set("Authorization","Bearer ".concat(t));let a=await fetch("".concat(r).concat(e),{...n,headers:l,cache:"no-store"});if(!a.ok){let e=await a.text().catch(()=>"");throw Error("API ".concat(a.status,": ").concat(e||a.statusText))}return a.json()}},4282:function(e,n,t){"use strict";t.d(n,{DH:function(){return s},J1:function(){return i},PR:function(){return c},oC:function(){return u}});var r=t(6300).Buffer;let l="taxi_token",a="taxi_user";function i(e,n){localStorage.setItem(l,e),localStorage.setItem(a,JSON.stringify(n))}function c(){let e=localStorage.getItem(a);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function s(){localStorage.removeItem(l),localStorage.removeItem(a)}function u(){let e=localStorage.getItem(l);return e?!function(e){let n=function(e){let n=e.split(".");if(3!==n.length)return null;try{let e=function(e){try{let n=e.length%4==2?"==":e.length%4==3?"=":e.length%4==1?"===":"",t=e.replace(/-/g,"+").replace(/_/g,"/")+n;if("function"==typeof atob)return atob(t);return r.from(t,"base64").toString("binary")}catch(e){return""}}(n[1]);return JSON.parse(e)}catch(e){return null}}(e);return null!=n&&!!n.exp&&Math.floor(Date.now()/1e3)>=n.exp}(e)?e:(s(),null):null}}},function(e){e.O(0,[300,138,971,23,744],function(){return e(e.s=4104)}),_N_E=e.O()}]);